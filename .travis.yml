sudo: required
dist: trusty
language: node_js
node_js:
  - '6.11'

services:
  - docker

env:
  global:
     CF_TARGET_URL="https://api.eu-de.bluemix.net"

before_install:
  - npm install -g @angular/cli@1.0.0 --loglevel error

before_script:
  - provider: script
    skip_cleanup: true
    script: ./install-bx.sh
    on:
      branch: master
  - provider: script
    skip_cleanup: true
    script: ./bx-login.sh
    on:
      branch: master

script:
  - npm run setup
  - npm run build
  - npm run push
  - kubectl delete --ignore-not-found=true -f kubernetes.yml
  - kubectl create -f kubernetes.yml
